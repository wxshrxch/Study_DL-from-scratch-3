# 제 1고지. 미분 자동 계산 (5)

# 역전파 이론

- **수치미분**은 계산 비용과 정확도면에서 **단점**이 있음
- **역전파를 이용하면 미분을 효율적으로 계산할 수 있고, 결괏값의 오차도 더 작음**

## 연쇄법칙 (Chain rule)

- 합성 함수의 미분은 구성함수 각각을 미분한 후 곱한 것과 같음
    - 즉, x에 대한 y의 미분은 구성 함수 각각의 미분값을 모두 곱한 것과 같음
    - 합성 함수의 미분은 각 함수의 국소적인 미분들로 분해 할 수 있음
- ${\operatorname{d}\!y\over\operatorname{d}\!y}$ 를 식 앞에 명시할 수 도 있음
    - 항상 ‘자신’에 대한 미분이라 값이 1
    - $y$가 작은 값만큼 변하면 자기 자신인 $y$도 같은 크기 만큼 변하므로 변화율이 어떤 함수의 경우에도 항상 1

### 역전파 원리 도출

- 역전파는 보통 계산과는 반대 방향으로 미분을 계산 (출력에서 입력방향으로)
    - 포워드 모드 자동 미분 : 입력에서 출력 방향으로 계산하는 방법
- 미분 값이 ‘y의 각 변수에 대한 미분값’이 전파됨 → 역전파
- 계산순서
    - 출력→ 입력
        - y의 미분값을 전파하기 위해서, 즉  중요요소가 y
    - 입력 → 출력
        - x의 미분값을 전파하기 위해서, 즉 중요요소가 x
- 머신러닝은 주로 대량의 매개변수를 입력받아서 마지막에 손실 함수(loss function)을 거쳐 출력을 내는 형태로 진행됨
- 손실 함수의 출력은 (많은 경우) 단일한 스칼라 값이며,
이 값이 ‘중요 요소’ 이다.
- 즉, **손실 함수의 각 매개변수에 대한 미분을 계산해야 함**
    - 미분 값을 출력에서 입력 방향으로 전파하면 한 번의 전파만으로 모든 매개변수에 대한 미분을 계산할 수 있음
    - 효율적 계산이 가능

### 순전파와 역전파

- 변수는 ‘통상값(순전파 값)’과 ‘미분값’이 존재하고, 함수는 ‘통상 계산(순전파)’과 ‘미분 값을 구하기 위한 계산(역전파)’이 존재함

- 역전파 시에는 순전파 시 이용한 데이터가 필요함
- 역전파를 구현하려면 먼저 순전파를 하고, 이 때 각 함수가 입력 변수의 값을 기억해 두어야 함